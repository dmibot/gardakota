<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>Garda Dumai Modern</title>
</head>
<body>
    <div class="app-header">
        <img src="https://upload.wikimedia.org/wikipedia/commons/a/ac/Logo_Kota_Dumai.png" width="30">
        <h1>GARDA DUMAI</h1>
        <a href="modul/admin/login.html" class="header-icon"><i class="fas fa-user-circle"></i></a>
    </div>

    <div class="container">
        <div style="background: #FFF3E0; color: #E65100; padding: 8px 12px; border-radius: 8px; font-size: 12px; font-weight: 600; margin-bottom: 15px;">
            <marquee id="msg-admin">ðŸ“¢ Memuat instruksi terbaru...</marquee>
        </div>

        <div class="card modern-widget">
            <div class="widget-icon bg-blue-light"><i class="fas fa-cloud-sun"></i></div>
            <div class="widget-data" style="flex:1;">
                <small>Cuaca Dumai Kota</small>
                <h3 id="w-temp">--Â°C</h3>
            </div>
            <div style="text-align:right;">
                <div id="w-desc" style="font-size:12px; font-weight:600; text-transform:uppercase; color:var(--primary);">...</div>
                <small style="font-size:10px; opacity:0.6;">BMKG Official</small>
            </div>
        </div>

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px;">
             <div class="card modern-widget" style="margin:0; padding: 15px;">
                <div class="widget-icon" style="background:#FFE0E6; color: var(--danger); width:40px; height:40px; font-size:18px;"><i class="fas fa-clock"></i></div>
                <div class="widget-data">
                    <h3 id="st-proses">0</h3>
                    <small>Proses</small>
                </div>
            </div>
             <div class="card modern-widget" style="margin:0; padding: 15px;">
                <div class="widget-icon" style="background:#E0F7FA; color: var(--success); width:40px; height:40px; font-size:18px;"><i class="fas fa-check-circle"></i></div>
                <div class="widget-data">
                    <h3 id="st-selesai">0</h3>
                    <small>Selesai</small>
                </div>
            </div>
        </div>

        <a href="modul/aksi/index.html" class="btn-main btn-danger">
            <i class="fas fa-bolt" style="margin-right:10px;"></i> SOS & DARURAT
        </a>
    </div>

    <nav class="bottom-nav">
        <a href="index.html" class="nav-item active"><i class="fas fa-house-chimney"></i></a>
        <a href="modul/peta/index.html" class="nav-item"><i class="fas fa-map-location-dot"></i></a>
        <a href="modul/aksi/index.html" class="nav-item"><i class="fas fa-triangle-exclamation"></i></a>
        <a href="modul/operator/index.html" class="nav-item"><i class="fas fa-plus-circle" style="font-size:28px; color:var(--primary);"></i></a>
    </nav>

    <script>
        const SAKTI = "https://script.google.com/macros/s/AKfycbwCKYJOQyULCxf5skOQ5AC9BpgR9beG3Uw3M1iMTEOoUgkRPvtGlybwK9iz19PGD0P5ww/exec";
        const BMKG_CUACA = "https://api.bmkg.go.id/publik/prakiraan-cuaca?adm4=14.72.06.1001";

        async function syncData() {
            try {
                // Cuaca BMKG
                const wReq = await fetch(BMKG_CUACA);
                const wData = await wReq.json();
                const now = wData.data[0].cuaca[0][0];
                document.getElementById('w-temp').innerText = now.t + "Â°C";
                document.getElementById('w-desc').innerText = now.weather_desc;

                // Stats Admin
                const sReq = await fetch(SAKTI);
                const sData = await sReq.json();
                document.getElementById('st-proses').innerText = sData.laporan.filter(i => i[6] !== 'Selesai' && i[6] !== 'Status').length;
                document.getElementById('st-selesai').innerText = sData.laporan.filter(i => i[6] === 'Selesai').length;
                if(sData.info && sData.info[0]) document.getElementById('msg-admin').innerText = sData.info[0][1];
            } catch(e) {}
        }
        syncData(); setInterval(syncData, 60000);
    </script>
</body>
</html>
